@startuml Kaytu_Container
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

Person(user, "User")

System_Ext(awsS3, "AWS S3 Buckets")
System_Ext(openAI, "OpenAI")

System_Boundary(kaytuWorkspace, "Kaytu Workspace") {
    ContainerDb(workspacePostgres, "Database", "PostgreSQL", "Holds benchmarks, policies and insights")
    ContainerDb(elastic, "Database", "ElasticSearch", "Holds benchmark evaluation results")
    ContainerQueue(rabbitMQ, "Database", "RabbitMQ", "Queue for running migrator")

    Container(onboardService, "Onboard service", "Go", "")
    Container(inventoryService, "Inventory service", "Go", "")

    Container(complianceService, "Compliance service", "Go", "")
    Rel(complianceService, elastic, "")
    Rel(complianceService, openAI, "retriving remediation steps generated by ai")
    Rel(complianceService, workspacePostgres, "")
    Rel(complianceService, rabbitMQ, "")
    Rel(complianceService, awsS3, "retriving insight results")
    Rel(complianceService, onboardService, "retriving connection info")
    Rel(complianceService, inventoryService, "retriving insight details")
}

Rel(user, complianceService, "uses APIs", "HTTPS")

@enduml